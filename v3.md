```mermaid
flowchart LR
  U[User or Frontend] -->|HTTP plus traceparent| GW[API Gateway or Front Door]
  GW --> APP[Agent API FastAPI or Azure Functions]

  subgraph APP[Agent App]
    INIT[init_observability at startup]
    API[API Route or Middleware]
    ORCH[Agent Orchestrator]
    GR[Guardrails]
    CACH[Cache]
    RAG[RAG Pipeline]
    TOOLS[Tool Runner]
    MGW[Model Gateway]
  end

  API --> ORCH
  ORCH --> GR
  ORCH --> CACH
  ORCH --> RAG
  ORCH --> TOOLS
  ORCH --> MGW

  RAG --> VDB[Vector DB or Search]
  TOOLS --> SVC[Downstream Services]
  MGW --> AOAI[Azure OpenAI]
  APP --> |OTLP traces or metrics | COL[OTel Collector recommended]
  COL --> DT[Dynatrace Observability Backend]
  COL --> AM[Azure Monitor optiona]
